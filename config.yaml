# IPFS Media Collection Publisher Configuration

# IPFS node configuration
ipfs:
  # Mode: "external" (use existing IPFS node) or "embedded" (run IPFS inside app)
  mode: "embedded"
  
  # External node settings (used when mode: external)
  external:
    api_url: "http://localhost:5001"
    timeout: 300  # seconds
    add_options:
      nocopy: false
      pin: true
      chunker: "size-262144"
      raw_leaves: true
  
  # Embedded node settings (used when mode: embedded)
  embedded:
    # repo_path: "~/.ipfs_publisher/ipfs-repo"
    repo_path: "./ipfs_publisher/ipfs-repo"
    swarm_port: 4002
    api_port: 5002
    gateway_port: 8081
    add_options:
      nocopy: true  # Use filestore to reference files without copying (saves disk space)
                    # NOTE: Files must be inside repo_path or its subdirectories for filestore to work
      pin: true
      chunker: "size-262144"
      raw_leaves: true
    bootstrap_peers: []
    gc:
      enabled: true
      interval: 86400  # seconds (24 hours)
      min_free_space: 1073741824  # bytes (1GB)

# PubSub configuration (always uses embedded implementation)
pubsub:
  enabled: true  # Enable PubSub announcements
  topic: "mdn/collections/announce"
  # announce_interval: 3600  # seconds (1 hour)
  announce_interval: 15
  bootstrap_peers: []
  listen_port: 0  # 0 = random port

# Application base directory (where keys, state, index and logs are stored)
# Default: ~/.ipfs_publisher
base_dir: "~/.ipfs_publisher"

# Directories to monitor
directories:
  - "./ipfs_publisher/ipfs-repo/media"
  # - "~/.ipfs_publisher/media"  # For nocopy mode, directories must be inside or symlinked to repo_path

# File extensions to process (case-insensitive)
extensions:
  - "mp3"
  - "flac"
  - "wav"
  - "mp4"
  - "mkv"
  - "avi"

# Logging
logging:
  level: "info"  # debug, info, warn, error
  file: "./ipfs_publisher/logs/app.log"
  max_size: 100  # MB
  max_backups: 5
  console: true

# Application behavior
behavior:
  scan_interval: 10  # seconds
  batch_size: 10
  progress_bar: true
  state_save_interval: 60  # seconds
